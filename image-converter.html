<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Converter</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-5">
    <div class="card shadow-sm mx-auto" style="max-width: 600px;">
        <div class="card-body">
            <h1 class="card-title text-center mb-4">Image Converter</h1>

            <div class="mb-3">
                <label for="inputFile" class="form-label">Select Image</label>
                <input class="form-control" type="file" id="inputFile" accept="image/*">
            </div>

            <div class="mb-3">
                <label for="formatSelect" class="form-label">Choose Format</label>
                <select class="form-select" id="formatSelect">
                    <option value="jpg">JPEG</option>
                    <option value="png">PNG</option>
                    <option value="gif">GIF</option>
                    <option value="bmp">BMP</option>
                    <option value="tiff">TIFF</option>
                    <option value="webp">WEBP</option>
                    <option value="svg">SVG</option>
                    <option value="ico">ICO</option>
                </select>
            </div>

            <div class="d-grid mb-3">
                <button class="btn btn-success btn-lg" onclick="convertImage()">Convert</button>
            </div>

            <a id="downloadLink" class="btn btn-primary w-100 mb-3 d-none">Download Converted Image</a>

            <div class="text-center">
                <img id="preview" class="img-fluid rounded shadow-sm" alt="Preview">
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap JS Bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
    const inputFile = document.getElementById('inputFile');
    const formatSelect = document.getElementById('formatSelect');
    const preview = document.getElementById('preview');
    const downloadLink = document.getElementById('downloadLink');

    inputFile.addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                preview.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
    });

    function convertImage() {
        const file = inputFile.files[0];
        if (!file) {
            alert('Please select an image file first!');
            return;
        }

        const format = formatSelect.value;
        const image = new Image();
        image.src = URL.createObjectURL(file);

        image.onload = function() {
            const canvas = document.createElement('canvas');
            canvas.width = image.width;
            canvas.height = image.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(image, 0, 0);

            let mimeType;
            switch(format) {
                case 'jpg': mimeType = 'image/jpeg'; break;
                case 'png': mimeType = 'image/png'; break;
                case 'webp': mimeType = 'image/webp'; break;
                case 'bmp': mimeType = 'image/bmp'; break;
                case 'gif': mimeType = 'image/gif'; break;
                case 'tiff': mimeType = 'image/tiff'; break;
                case 'ico':
                case 'svg':
                case 'heif':
                case 'raw':
                    alert('This format requires server-side conversion. Use JPEG, PNG, WEBP, GIF, BMP, or TIFF.');
                    return;
                default: mimeType = 'image/png';
            }

            canvas.toBlob(blob => {
                const url = URL.createObjectURL(blob);
                downloadLink.href = url;
                downloadLink.download = `converted-image.${format}`;
                downloadLink.classList.remove('d-none');
            }, mimeType);
        };
    }
</script>
</body>
</html>
